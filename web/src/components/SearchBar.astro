---
export interface Props {
  initialInput?: string;
  initialMatchSelection?: string;
}
const { initialInput = "", initialMatchSelection = "prefix" } = Astro.props;
---

<!-- Following the same approach as kit.svelte.dev/src/lib/search/SearchBox.svelte, with some hints from MDN's page about navigator.platform -->
<script>
  const sbi = document.getElementById("sbi");
  window.addEventListener("keydown", (event) => {
    let modifier = "ctrlKey";
    if (
      navigator.platform.indexOf("Mac") === 0 ||
      navigator.platform === "iPhone"
    ) {
      modifier = "metaKey";
    }
    if (event.key === "k" && event[modifier]) {
      sbi.focus();
      event.preventDefault();
    }
  });
</script>

<div class="relative mt-2 mb-2">
  <form action="/search" class="flex h-8" id="sf">
    <select class="btnColor rounded-l" name="m">
      <option selected={initialMatchSelection == "prefix"} value="prefix"
        >開頭為</option
      >
      <option selected={initialMatchSelection == "suffix"} value="suffix"
        >結尾為</option
      >
      <option selected={initialMatchSelection == "contains"} value="contains"
        >包含</option
      >
    </select>
    <input
      class="fade peer w-full border-b-2 border-gray-200 bg-white hover:border-gray-300 dark:border-stone-800 dark:bg-stone-900 dark:hover:border-stone-700"
      type="search"
      autocomplete="off"
      placeholder="輸入欲搜尋的詞彙"
      name="q"
      id="sbi"
      value={initialInput}
    />
    <!-- /search?q=<...>, like search engines -->
    <input class="btnColor rounded-r" type="submit" value="搜尋" />
    <div
      class="absolute right-14 top-[calc(50%-0.9rem)] text-right peer-hover:hidden peer-focus:hidden max-sm:hidden"
    >
      <kbd>Ctrl</kbd>
      <kbd>K</kbd>
    </div>
  </form>
</div>
